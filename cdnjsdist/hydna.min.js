/*
hydna.js v1.0.1
Copyright (c) Hydna AB 2010-2014

For more info, please visit https://www.hydna.com
*/

!function(e){"use strict;";function t(e,t){for(var n=[],r=t,o=e.byteLength;o>r;r++)n.push(String.fromCharCode(e[r]));return gt(vt(n.join("")))}function n(e){for(var t=[],n=0,r=e.length;r>n;n++)t[n]=e.charCodeAt(n);return t}function r(e){var t;t=new Uint8Array(e.length);for(var n=0,r=e.length;r>n;n++)t[n]=e.charCodeAt(n);return t.buffer}function o(e,t,n,r){var o,i,s,a,l,c=0,h=0;if(l=z,r)if("string"==typeof r){o=bt(mt(r)),s=new Uint8Array(o.length);for(var u=0,d=o.length;d>u;u++)s[u]=o.charCodeAt(u);i=s.buffer,h=i.byteLength}else if(r instanceof Et)l=Y,i=r,h=r.byteLength;else if(r.buffer instanceof Et)l=Y,i=r.buffer,c=r.byteOffset,h=r.byteLength;else{if(!r.length)throw new Error("UNSUPPORTED_TYPE_ERR");l=Y,s=new Uint8Array(r.length);for(var u=0,d=r.length;d>u;u++)s[u]=parseInt(r[u]);i=s.buffer,h=this.data.byteLength}if(5+h>K)throw new Error("FRAME_OVERFLOW_ERR");return a=new Et(5+h),s=new Uint8Array(a),s[0]=e>>>24&255,s[1]=e>>>16&255,s[2]=e>>>8&255,s[3]=e%256,s[4]=l<<Ht|t<<It|n,h&&s.set(new Uint8Array(i,c,h),5),a}function i(e,t,n,r){var o,i,s,a,l,c;if(c=z,r)if("string"==typeof r)a=bt(mt(r));else if(r instanceof Et||r.buffer instanceof Et){c=Y,o=r.buffer||r,s=new Uint8Array(o,r.byteOffset||0,r.byteLength),a=[];for(var h=0,u=s.byteLength;u>h;h++)a[h]=String.fromCharCode(s[h])}else{if(!r.length)throw new Error("UNSUPPORTED_TYPE_ERR");c=Y,a=[];for(var h=0,u=r.length;u>h;h++)b=(parseInt(r[h])%256+256)%256,a[h]=String.fromCharCode(b)}if(i=new Array,i[0]=String.fromCharCode(e>>>24&255),i[1]=String.fromCharCode(e>>>16&255),i[2]=String.fromCharCode(e>>>8&255),i[3]=String.fromCharCode(255&e),i[4]=String.fromCharCode(c<<Ht|t<<It|n),a&&(i=i.concat(a)),l=Nt(i.join("")),l.length>V)throw new Error("FRAME_OVERFLOW_ERR");return l}function s(e){if("string"==typeof e)return bt(mt(e)).length;if(e instanceof Et||e.buffer instanceof Et)return e.byteLength;if(e.length)return e.length;throw new Error("UNSUPPORTED_TYPE_ERR")}function a(e){var n,r,o,i,s,a,l;if((s=e.data)instanceof Et==!1)return this.close(null,ct,"ERR_UNSUPPORTED_TYPE");if(e.data.byteLength<5)return this.close(null,ct,"ERR_BAD_HEADER_SIZE");if(s=new Uint8Array(e.data),n=(s[1]<<16|s[2]<<8|s[3])+(s[0]<<24>>>0),desc=s[4],r=(desc&Pt)>>Ht,o=(desc&Lt)>>It,i=desc&Ot,s.byteLength>5)try{r==z?a=t(s,5):(l=new Uint8Array(s.length-5),l.set(s.subarray(5)),a=l.buffer)}catch(c){return this.close(null,ct,"ENCODING_ERR")}this.onframe&&this.onframe(n,o,i,a)}function l(e){var t,n,r,o,i,s,a=e.data;if(!a||!a.length)return this.close(null,ct,"ERR_UNSUPPORTED_TYPE");if(a.length<8)return this.close(null,ct,"BAD_HEADER_SIZE_ERR");try{a=At(a)}catch(l){return this.close(null,ct,"ENCODING_ERR")}if(t=(a.charCodeAt(1)<<16|a.charCodeAt(2)<<8|a.charCodeAt(3))+(a.charCodeAt(0)<<24>>>0),s=a.charCodeAt(4),o=(s&Pt)>>Ht,n=(s&Lt)>>It,r=s&Ot,a.length>5)try{i=o==z?gt(vt(a.substr(5))):wt(a.substr(5))}catch(l){return this.close(null,ct,"ENCODING_ERR")}this.onframe&&this.onframe(t,n,r,i)}function c(e){var t,n=0;return e?"string"==typeof e&&(t=e.match(at))?(t[1]&&(n|=Q),t[2]&&(n|=et),t[3]&&(n|=tt),n):null:0}function h(e){var t,n;if(!e||"string"==typeof e)return e;if("function"==typeof e.slice)return e.slice(0);n=new Uint8Array(e),t=new Uint8Array(n.length);for(var r=0,o=n.length;o>r;r++)t[r]=n[r];return t}function u(e,t){this.target=e,this.data=t}function d(e,t,n){this.target=e,this.priority=t,this.data=n}function f(e,t){this.target=e,this.data=t}function p(e,t){this.target=e,this.data=t,this.message=t,this.message="string"==typeof t?t:"UNKNOWN_ERR"}function y(e,t,n){this.target=e,this.wasClean=t==lt,this.wasDenied=t==ft,this.hadError=!this.wasClean&&!this.wasDenied,this.code=t,this.reason=n||"",this.data=n}function m(e,t,n){if("string"!=typeof t)throw new Error("Expected `event` as String");if("function"!=typeof n)throw new Error("Expected `handler` as Function");e._events[t]?"function"!=typeof e._events[t]?e._events[t].push(n):e._events[t]=[e._events[t],n]:e._events[t]=n}function g(e,t,n){var r,o;if(t&&n&&(o=e._events[t]))if("function"==typeof o)o==n&&delete e._events[t];else for(r=o.length;r--;)if(o[r]==n){o.splice(r,1),1==o.length&&(e._events[t]=o[0]);break}}function v(e,t,n){try{n.call(e,t)}catch(r){St(function(){throw r})}}function E(e){var t,n,r;if(e&&"string"==typeof(t=e.type)&&(r=e.target)&&((n=r["on"+t])&&v(r,e,n),n=r._events[e.type]))if("function"!=typeof n)for(var o=0,i=n.length;i>o;o++)v(r,e,n[o]);else v(r,e,n)}function w(t,n,r){var o,i,s,a,l,c,h;if(r&&"auto"!==r.transport)o=r.transport,h=!1;else if("__FORCE_TRANSPORT_SOCKET__"in e)o=e.__FORCE_TRANSPORT_SOCKET__,h=!1;else{if(null==Dt)throw new Error("Browser does not support any of the transport protocols");o=Dt,h=r&&r.allowTransportFallback?r.allowTransportFallback:!0}if(o in xt==!1)throw new Error("Bad transport '"+o+"'");if(l=C(n),a=_(l,o),c=n.path,s=Ut[a])for(var u=0;u<s.length;u++)if(c in s[u].channels==!1){i=s[u];break}return i||(i=new k(l,o,h),o in Ut==!1&&(Ut[a]=[]),Ut[a].push(i)),i.createChannel(t,n.path),i}function _(e,t){return[t,e].join(":")}function C(e){var t;return t=[e.protocol,"://",e.host],e.port&&t.push(":"+e.port),t.join("")}function k(e,t,n){this.url=e,this.transport=t,this.refcount=0,this.channels={},this.routes={},this.socket=null,this.connecting=!1,this.connected=!1,this.keepAliveTimer=null,this.lastSentMessage=0,this.allowTransportFallback=n,this.bindTransport()}function T(){this.connected=!0,this.initTimer&&(clearTimeout(this.initTimer),this.initTimer=null),this.onopen&&this.onopen()}function N(e){this.onmessage&&this.onmessage({type:"message",data:e})}function A(e){this.close(yt,e||"BRIDGE_UNKNOWN_ERR")}function S(){this.close(ut,"BRIDGE_UNKNOWN_ERR")}function R(e,t,n){var r,o;if(!Dt)throw new Error("Not supported in current browser");if("string"!=typeof e)throw new Error("bad argument, `url`, expected String");if(/^http:\/\/|^https:\/\//.test(e)===!1&&(o=/^http/.test(location.protocol)?location.protocol:"http:",e=o+"//"+e),r=Rt(e),"https"!==r.protocol&&"http"!==r.protocol)throw new Error("bad protocol, expected `http` or `https`");if("number"!=typeof(this._mode=c(t)))throw new Error("Invalid mode");try{this._connection=w(this,r,n)}catch(i){throw this._mode=0,i}this._path=r.path,this.url=this._connection.url+this._path,this.transport=this._connection.transport,this._token=r.query||null,this._ptr=null,this._resolved=!1,this._endsig=null,this._events={},this.readyState=R.CONNECTING,this.readable=(this._mode&Q)===Q,this.writable=(this._mode&et)===et,this.emitable=(this._mode&tt)===tt}function O(e){var t,n;t=Rt(e),n=("http"===t.protocol?"ws://":"wss://")+t.host,t.port&&(n+=":"+t.port),Ft.WebSocket||Ft.init(n);try{socket=new Ft.WebSocket(n,["wsutf.winkprotocol.org"].concat(Ft.binarySupport?["wsbin.winkprotocol.org"]:[]))}catch(r){return St(function(){socket.onclose({code:yt,message:r.message||"Failed to connect to remote"})})}return Ft.binarySupport?(socket.binaryType="arraybuffer",socket.onmessage=a,socket.createFrame=o):(socket.onmessage=l,socket.createFrame=i),"bufferedAmount"in socket==!1&&(socket.bufferedAmount=0),socket}function I(){var t,n,r,o=e.navigator,i="application/x-shockwave-flash";if(/android/i.test(o.userAgent))return!1;if("undefined"!=typeof o.plugins&&(r=o.plugins["Shockwave Flash"])&&r.description&&(mime=o.mimeTypes)&&mime[i]&&mime[i].enabledPlugin)return n=/\s(\d+)/.exec(r.description),n[1]&&parseInt(n[1])>9;if(t=e.ActiveXObject)try{if(r=new t("ShockwaveFlash.ShockwaveFlash"))return n=/\s(\d+)/.exec(r.GetVariable("$version")),n[1]&&parseInt(n[1])>9}catch(s){return!1}return!1}function L(e){var t=this;this.id=_t(),this.url=e,this.connected=!1,this.initTimer=setTimeout(function(){t.errorHandler("FLASH_INIT_TIMEOUT_ERR")},15e3)}function H(e){var t;return t=new L(e),Gt.sockets[t.id]=t,Gt.bridge||Gt.embed(),Gt.ready&&t.init(),t}function P(e){function t(){var e=document.getElementById(n);a.bridge=e.contentWindow,a.bridge.postMessage(String(a.id),"*")}var n,r,o,i,s,a=this;this.id=_t(!0),this.url=e,this.connected=!1,this.bridge=null,n=Wt.idprefix+this.id+Wt.idsuffix,this.elem=document.createElement("iframe"),this.elem.setAttribute("id",n),this.elem.style.width="0px",this.elem.style.height="0px",this.elem.style.visibility="hidden",r=Rt(this.url),o=r.port?":"+r.port:"",i=r.protocol+"://"+r.host+o+M,i=i+"?origin="+Wt.origin,this.elem.src=i,"addEventListener"in this.elem?this.elem.addEventListener("load",t,!1):"attachEvent"in this.elem?this.elem.attachEvent("onload",t):this.elem.onload=t,s=document.getElementsByTagName("body")[0],s.appendChild(this.elem),this.initTimer=setTimeout(function(){a.errorHandler("COMET_INIT_TIMEOUT_ERR")},1e4)}function x(e){var t;return t=new P(e),Wt.sockets[t.id]=t,Wt.socketCount++,Wt.inititalized||Wt.init(),t}var D="1.0.1",U="HydnaChannel",M="/comet/",F="//cdnjs.cloudflare.com/ajax/libs/hydna/1.0.1/bridge.swf",G=!1,W=!1,B=!1,j=65530,K=65535,V=87380,z=0,Y=1,q=0,Z=1,X=2,$=3,J=4,Q=1,et=2,tt=4,nt=0,rt=0,ot=1,it=7,st=0,at=/^(r|read){0,1}(w|write){0,1}(?:\+){0,1}(e|emit){0,1}$/i,lt=1e3,ct=1002,ht=1005,ut=1006,dt=1007,ft=5e3,pt=5001,yt=5003,mt=e.encodeURIComponent,gt=e.decodeURIComponent,vt=e.escape,bt=e.unescape,Et=e.ArrayBuffer,wt=null;void 0==Et?(Et=function(){},wt=n):wt=r;var _t=function(){var e=1;return function(t){var n=e++;if(!t)return n;for(n=e.toString(16);n.length<8;)n=0+n;return n}}(),Ct=Date.now||function(){return(new Date).getTime()},kt=function(){switch(!0){case"undefined"!=typeof module&&"undefined"!=typeof module.exports:return"common";case"function"==typeof define&&!!define.amd:return"amd"}return"global"}(),Tt={};Tt.PADCHAR="=",Tt.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tt.getbyte64=function(e,t){var n=Tt.ALPHA.indexOf(e.charAt(t));if(-1==n)throw"Cannot decode base64";return n},Tt.decode=function(e){e=""+e;var t,n,r,o=Tt.getbyte64,i=e.length;if(0==i)return e;if(i%4!=0)throw"Cannot decode base64";t=0,e.charAt(i-1)==Tt.PADCHAR&&(t=1,e.charAt(i-2)==Tt.PADCHAR&&(t=2),i-=4);var s=[];for(n=0;i>n;n+=4)r=o(e,n)<<18|o(e,n+1)<<12|o(e,n+2)<<6|o(e,n+3),s.push(String.fromCharCode(r>>16,r>>8&255,255&r));switch(t){case 1:r=o(e,n)<<18|o(e,n+1)<<12|o(e,n+2)<<6,s.push(String.fromCharCode(r>>16,r>>8&255));break;case 2:r=o(e,n)<<18|o(e,n+1)<<12,s.push(String.fromCharCode(r>>16))}return s.join("")},Tt.getbyte=function(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n},Tt.encode=function(e){if(1!=arguments.length)throw"SyntaxError: Not enough arguments";var t,n,r=Tt.PADCHAR,o=Tt.ALPHA,i=Tt.getbyte,s=[];e=""+e;var a=e.length-e.length%3;if(0==e.length)return e;for(t=0;a>t;t+=3)n=i(e,t)<<16|i(e,t+1)<<8|i(e,t+2),s.push(o.charAt(n>>18)),s.push(o.charAt(n>>12&63)),s.push(o.charAt(n>>6&63)),s.push(o.charAt(63&n));switch(e.length-a){case 1:n=i(e,t)<<16,s.push(o.charAt(n>>18)+o.charAt(n>>12&63)+r+r);break;case 2:n=i(e,t)<<16|i(e,t+1)<<8,s.push(o.charAt(n>>18)+o.charAt(n>>12&63)+o.charAt(n>>6&63)+r)}return s.join("")};var Nt=e.btoa||Tt.encode,At=e.atob||Tt.decode,St=null;St="undefined"!=typeof setImmediate?setImmediate:"undefined"!=typeof postMessage&&"undefined"!=typeof window?function(){function t(t){var o;t.source==e&&t.data===n&&(o=r.shift())&&o()}var n="nextTick."+(65535*Math.random()&65535).toString(),r=[],o=1;return e.addEventListener?e.addEventListener("message",t,!1):e.attachEvent?e.attachEvent("onmessage",t):e.onmessage=t,function(t){return r.push(t),e.postMessage(n,"*"),o++}}():function(e){setTimeout(e,0)};var Rt=function(){var e=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];return function(n){for(var r,o=e.exec(n),i={},s=14;s--;)o[s]&&(i[t[s]]=o[s]);return(r=i.authority)&&-1!==(s=r.indexOf("@"))&&(i.authority=r.substr(s+1)),i.path=i.path||"/",i}}(),Ot=7,It=3,Lt=7<<It,Ht=6,Pt=1<<Ht;u.prototype.type="open",d.prototype.type="message",f.prototype.type="signal",p.prototype.type="error",y.prototype.type="close";var xt={},Dt=null,Ut={};k.prototype.bindTransport=function(){var e,t,n=this;e=xt[n.transport],t=e(n.url),t.onopen=function(){var e=n.channels;n.connected=!0,n.connecting=!1;for(var t in e)n.send(0,J,0,t);n.startKeepAliveTimer()},t.onframe=function(e,t,r,o){switch(t){case q:return;case Z:return n.processOpen(e,r,o);case X:return n.processData(e,r,o);case $:return n.processSignal(e,r,o);case J:return n.processResolve(e,r,o)}},t.onerror=function(e){n.socket=null,this.onopen=null,this.onclose=null,this.onerror=null,this.onframe=null,n.destroy(e)},t.onclose=function(e){var t,r;return n.socket=null,this.onopen=null,this.onclose=null,this.onerror=null,this.onframe=null,e?(r=e.code||lt,r!=lt&&(t=e.message||e.reason||"Connection reset by server")):(r=e.code||ut,t="Connection reset by server"),r==yt&&n.connecting===!0&&n.allowTransportFallback===!0&&"fallbackTransport"in this&&this.fallbackTransport in xt?(n.transport=this.fallbackTransport,n.bindTransport(),void 0):(n.destroy(null,r,t),void 0)},t._destroyed=!1,t.destroy=function(e,t,n){this._destroyed||(this._destroyed=!0,e&&this.onerror&&this.onerror(e),t&&this.onclose&&this.onclose(null,t,n),this.close())},this.socket=t,this.connecting=!0},k.prototype.createChannel=function(e,t){var e,n=this.channels;if(t in n)throw new Error("Channel already created");n[t]=e,this.refcount++,this.connected&&this.send(0,J,0,t)},k.prototype.destroyChannel=function(e,t,n,r){var o=this.channels,i=this.routes;"string"==typeof e._path&&(delete o[e._path],"number"==typeof e._ptr&&delete i[e._ptr],e._onend(t,n,r),0==--this.refcount&&this.destroy())},k.prototype.send=function(e,t,n,r){var o;return this.socket&&this.connected?(this.lastSentMessage=(new Date).getTime(),o=this.socket.createFrame(e,t,n,r),this.socket.send(o)):!1},k.prototype.startKeepAliveTimer=function(){var e=this;this.keepAliveTimer=setInterval(function(){var t=(new Date).getTime();t-e.lastSentMessage>=15e3&&e.send(0,q,0)},5e3),e.send(0,q,0)},k.prototype.processOpen=function(e,t,n){var r;return(r=this.routes[e])?(r.readyState!==R.CONNECTING&&this.destroy(null,ct,"CHANNEL_NOT_CONNECTING_ERR"),t==nt?r._onopen(n):this.destroyChannel(r,null,ft,n),void 0):(this.destroy(null,ct,"UNKNOWN_OPEN_RESP_ERR"),void 0)},k.prototype.processData=function(e,t,n){var r,o=this.routes;if(e===st)for(var i in o)r=o[i],r.readyState==R.OPEN&&r.readable&&E(new d(r,t,h(n)));else(r=o[e])&&r.readyState==R.OPEN&&r.readable&&E(new d(r,t,n))},k.prototype.processSignal=function(e,t,n){var r,o=this.routes;switch(t){case rt:if(e===st)for(var i in o)r=o[i],r.readyState==R.OPEN&&E(new f(r,h(n)));else(r=o[e])&&r.readyState==R.OPEN&&E(new f(r,n));break;case ot:case it:if(e===st)return t==ot?this.destroy(null,lt,n):this.destroy(null,pt,n),void 0;if(!(r=o[e]))return;r.readyState==R.CLOSING?this.destroyChannel(r,null,lt):(this.send(e,$,ot),t==ot?this.destroyChannel(r,null,lt,n):this.destroyChannel(r,null,pt,n));break;default:return this.destroy(null,ct,"Unknown signal flag SIGFLAG"),void 0}},k.prototype.processResolve=function(e,t,n){var r,o;if("string"!=typeof n||0==n.length)return this.destroy(null,dt,"Resolve payload empty"),void 0;if(o=n,r=this.channels[o]){if(r.readyState==R.CLOSING)return this.destroyChannel(r,null,lt),void 0;if(t!=nt)return this.destroyChannel(r,null,ft,"Unable to resolve path"),void 0;this.routes[e]=r,r._ptr=e,this.send(e,Z,r._mode,r._token)}},k.prototype.destroy=function(e,t,n){var r,o,i,s,a=this.channels;if(this.url){for(o=_(this.url,this.transport),r=Ut[o],s=r&&r.length||0;s--;)if(r[s]==this){r.splice(s,1),0==r.length&&delete Ut[o];break}this.url=null,this.connecting=!1,this.connected=!1,this.channels={},this.routes={},this.refcount=0,this.transport=null;for(var l in a)(i=a[l])&&i._onend(e,t,h(n));if(this.keepAliveTimer&&(clearInterval(this.keepAliveTimer),this.keepAliveTimer=null),this.socket){this.socket.onopen=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onframe=null;try{this.socket.close()}catch(e){}finally{this.socket=null}}}},R.CONNECTING=R.prototype.CONNECTING=0,R.OPEN=R.prototype.OPEN=1,R.CLOSING=R.prototype.CLOSING=2,R.CLOSED=R.prototype.CLOSED=3,R.prototype.extensions="",R.prototype.protocol="",R.prototype.binaryType="undefined"==typeof Et?void 0:"arraybuffer";try{Object.defineProperty(R.prototype,"bufferedAmount",{configurable:!0,enumerable:!0,get:function(){var e=this._connection&&this._connection.socket||null;return e?e.bufferedAmount:0}})}catch(Mt){R.prototype.bufferedAmount=0}R.prototype._onopen=function(e){return this._token=null,this.readyState===R.CLOSING?(this.channel.send($,ot,this._endsig),this._endsig=null,void 0):(this.readyState=R.OPEN,E(new u(this,e)),void 0)},R.prototype._onend=function(e,t,n){var r,t,o;this.readyState!==R.CLOSED&&(this.readyState=R.CLOSED,this._ptr=null,this._token=null,this._resolved=!1,this._mode=null,this._connection=null,this._endsig=null,e&&(r=new p(this,"string"==typeof e?e:e.message),E(r)),o=n,t||(t=ut,o="Connection to remote closed"),r=new y(this,t,o||null),E(r),this._path=null,this._url=null)},R.prototype.on=function(e,t){return m(this,e,t),this},R.prototype.off=function(e,t){return g(this,e,t),this},R.prototype.addEventListener=function(e,t){m(this,e,t)},R.prototype.removeEventListener=function(e,t){g(this,e,t)},R.prototype.send=function(e,t){var n=t||0;if(this.readyState!==R.OPEN)throw new Error("INVALID_STATE_ERR");if(!this.writable)throw new Error("NOT_WRITABLE_ERR");if(0>n||n>7||isNaN(n))throw new Error("Bad priority, expected Number between 0-7");if(!e||!e.length&&!e.byteLength)throw new Error("Expected `data`");return this._connection.send(this._ptr,X,n,e)},R.prototype.emit=function(e){if(this.readyState!==R.OPEN)throw new Error("INVALID_STATE_ERR");if(!this.emitable)throw new Error("NOT_EMITABLE_ERR");if(!e||!e.length&&!e.byteLength)throw new Error("Expected `data`");return this._connection.send(this._ptr,$,rt,e)},R.prototype.close=function(e){if(this.readyState===R.CONNECTING||this.readyState===R.OPEN){if("number"==typeof e&&(e=arguments[1]),e&&!e.length&&!e.byteLength)throw new Error("Expected `data`");this.readable=!1,this.writable=!1,this.emitable=!1,this.readyState===R.OPEN?this._connection.send(this._ptr,$,ot,e):this._endsig=e,this.readyState=R.CLOSING}};var Ft={WebSocket:null,binarySupport:!1,init:function(t){var n,r,o,i,s=e.WebSocket;if(e.MozWebSocket)s=e.MozWebSocket;else if((o="binaryType"in s.prototype)==!1)switch(n=navigator.userAgent,!0){case!!(i=/Chrome\/(\d+)/.exec(n))&&parseInt(i[1])>=15:case!!(i=/Firefox\/(\d+)/.exec(n))&&parseInt(i[1])>=11:case!!(i=/MSIE\s(\d+)/.exec(n))&&parseInt(i[1])>=10:case!!(i=/Version\/(\d+).+Safari/.exec(n))&&parseInt(i[1])>=6:bin=!0;break;default:try{r=new s(t),o=!!r.binaryType,r.close()}catch(a){}}Ft.binarySupport=o||!1,Ft.WebSocket=s}};"undefined"!=typeof G&&G!==!1||!e.WebSocket&&!e.MozWebSocket||(xt.websocket=O,Dt="websocket");var Gt={sockets:{},ready:!1,bridge:null,embed:function(){var t,n,r,o,i,s,a,l,c,h=[],u=[];if("global"!==kt){do n="__hydnaFlashTransport"+4294967295*Math.random();while(e.document.getElementById(n));window[n]=Gt}else n=U+".__bridge",R.__bridge=Gt;do c="__"+Ct();while(e.document.getElementById(c));i={onhandshake:1,onready:1,onopen:1,onclose:1,onerror:1,onmessage:1};for(var d in i)u.push(d+"="+n+"."+d);if(r="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0",o="http://www.macromedia.com/go/getflashplayer",s=F+"?"+4294967295*Math.random(),h[0]='<object name="'+c+'" id="'+c+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+r+'" name= width="1" height="1">',h[1]='<param name="allowScriptAccess" value="always"></param>',h[2]='<param name="allowNetworking" value="true"></param>',h[3]='<param name="movie" value="'+s+'"></param>',h[4]='<param name="quality" value="low"></param>',h[5]='<param name="menu" value="false"></param>',h[6]='<param name="FlashVars" value="'+u.join("&")+'">',h[7]='</param><param name="bgcolor" value="#ffffff"></param>',h[8]='<param name="wmode" value="transparent"></param>',h[9]='<embed  src="'+s+'" quality="low" bgcolor="#ffffff" wmode="transparent" width="1" height="1" swLiveConnect="true" allowScriptAccess="always" allowNetworking="true" menu="false" type="application/x-shockwave-flash" FlashVars="'+u.join("&")+'" pluginspage="'+o+'">',h[10]="</object>",l=document.createElement("div"),l.innerHTML=h.join(""),a=l.childNodes[0],!e.document.all)for(var f=0;f<a.childNodes.length;f++)if("EMBED"===a.childNodes[f].nodeName.toUpperCase()){a=a.childNodes[f];break}a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.width="1px",a.style.height="1px",a.style.zIndex="-100000",t=document.getElementsByTagName("body")[0],t.appendChild(a),Gt.bridge=a},onhandshake:function(){return"undefined"!=typeof navigator&&navigator.userAgent||"none"},onready:function(){return St(function(){var e,t=Gt.sockets;Gt.ready=!0;for(var n in t)e=Gt.sockets[n],e.init()}),!0},onopen:function(e){var t;(t=Gt.sockets[e])&&t.openHandler()},onmessage:function(e,t){var n;(n=Gt.sockets[e])&&n.messageHandler(t)},onerror:function(e,t){var n;(n=Gt.sockets[e])&&n.errorHandler(t)},onclose:function(e){var t;(t=Gt.sockets[e])&&t.closeHandler()}};L.prototype.bufferedAmount=0,L.prototype.fallbackTransport="comet",L.prototype.onmessage=l,L.prototype.createFrame=i,L.prototype.openHandler=T,L.prototype.closeHandler=S,L.prototype.errorHandler=A,L.prototype.messageHandler=N,L.prototype.init=function(){var e=Rt(this.url),t=e.protocol+"://"+e.host;return e.port&&(t+=":"+e.port),"https"===e.protocol?(this.errorHandler("FLASH_TLS_ERR"),void 0):(Gt.bridge.init(this.id,t),void 0)},L.prototype.send=function(e){var t=this.id;St(function(){Gt.bridge.send(t,e)})},L.prototype.close=function(e,t){this.id&&(this.connected&&(Gt.bridge.close(this.id),this.connected=!1),this.initTimer&&(clearTimeout(this.initTimer),this.initTimer=null),delete Gt.sockets[this.id],this.id=null,this.onclose&&this.onclose({type:"close",code:e||ht,reason:t||"FLASH_UNKNOWN_ERR"}))},"undefined"!=typeof W&&W!==!1||!I()||(xt.flash=H,Dt=Dt||"flash");var Wt={inititalized:!1,sockets:{},socketCount:0,idprefix:"__"+U.toLowerCase()+"__",idsuffix:"__bridge__",origin:e.location.origin||function(){var t=e.location;return"file:"==t.protocol?"file://":t.protocol+"://"+t.hostname}(),init:function(){"attachEvent"in e?e.attachEvent("onmessage",Wt.messageHandler):e.addEventListener("message",Wt.messageHandler,!1),Wt.inititalized=!0},destroy:function(){"detachEvent"in e?e.detachEvent("onmessage",Wt.messageHandler):e.removeEventListener("message",Wt.messageHandler,!1),Wt.inititalized=!1},messageHandler:function(t){var n,r,o,i;if(!(t.source==e||"string"!=typeof t.data||t.data.length<8)&&(o=t.data.substr(0,8),(n=Wt.sockets[o])&&n.messageHandler))switch(i=t.data.charCodeAt(8),r=t.data.length>8?t.data.substr(9):null,i){case 1:return n.openHandler();case 2:return n.errorHandler(r||"COMET_UNKNOWN_ERR");case 3:return n.messageHandler(r);default:return n.errorHandler("COMET_ILLGEALOP_ERR")}}};L.prototype.bufferedAmount=0,P.prototype.fallbackTransport=null,P.prototype.onmessage=l,P.prototype.createFrame=i,P.prototype.openHandler=T,P.prototype.closeHandler=S,P.prototype.errorHandler=A,P.prototype.messageHandler=N,P.prototype.send=function(e){this.bridge.postMessage(""+e,"*")},P.prototype.close=function(e,t){var n,r;this.id&&(delete Wt.sockets[this.id],this.id=null,Wt.socketCount--,0==Wt.socketCount&&Wt.destroy(),this.initTimer&&(clearTimeout(this.initTimer),this.initTimer=null),(n=this.bridge)&&(this.connected=!1,this.bridge=null,St(function(){try{n.postMessage("","*")}catch(e){}})),(r=this.elem)&&(this.elem=null,r.onload=null,setTimeout(function(){var e=document.getElementsByTagName("body")[0];try{e.removeChild(r)}catch(t){}},1)),this.onclose&&this.onclose({type:"close",code:e||ht,reason:t||"COMET_UNKNOWN_ERR"}))},"undefined"!=typeof B&&B!==!1||"undefined"==typeof e.postMessage||(xt.comet=x,Dt=Dt||"comet");var Bt="global"==kt?R:{};switch(Bt.VERSION=D,Bt.SUPPORTED=null!==Dt,Bt.WEBSOCKET="websocket"in xt,Bt.FLASH="flash"in xt,Bt.COMET="comet"in xt,Bt.MAXSIZE=j,Bt.sizeOf=s,"global"!==kt&&(Bt.Channel=R),kt){case"amd":define([],function(){return Bt});break;case"common":module.exports=Bt;break;default:if(U in e)throw new Error("Target name already taken, or is library already loaded");e[U]=Bt}}(this);
//# sourceMappingURL=hydna.map